p8105\_hw2\_bg2604
================
Boya Guo
10/5/2018

``` r
library(tidyverse)
```

    ## -- Attaching packages ------------------ tidyverse 1.2.1 --

    ## √ ggplot2 3.0.0     √ purrr   0.2.5
    ## √ tibble  1.4.2     √ dplyr   0.7.6
    ## √ tidyr   0.8.1     √ stringr 1.3.1
    ## √ readr   1.1.1     √ forcats 0.3.0

    ## -- Conflicts --------------------- tidyverse_conflicts() --
    ## x dplyr::filter() masks stats::filter()
    ## x dplyr::lag()    masks stats::lag()

``` r
library(readxl)
library(knitr)
```

``` r
knitr::opts_chunk$set((echo = TRUE),
  fig.width = 6,
  fig.asp = .6,
  out.width = "90%"
)
```

Problem 1
---------

1.1 Import NYC transit csv file usirng relative path, and clean the dataset.

``` r
transit_data = read_csv(file="./data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv")%>%
  janitor::clean_names() %>% 
  gather(key = route_number, value=route_name,route1:route11)%>%
  separate(route_number, into = c("route", "route_number"), sep = 5) %>%
  filter(!is.na(route_name))%>%
  select(line, station_name, station_latitude, station_longitude, route_number,route_name, entry, vending, entrance_type, ada)%>%
  mutate(entry=ifelse(entry=='YES',yes=TRUE,no=FALSE))%>%
  arrange(line,station_name)
```

    ## Parsed with column specification:
    ## cols(
    ##   .default = col_character(),
    ##   `Station Latitude` = col_double(),
    ##   `Station Longitude` = col_double(),
    ##   Route8 = col_integer(),
    ##   Route9 = col_integer(),
    ##   Route10 = col_integer(),
    ##   Route11 = col_integer(),
    ##   ADA = col_logical(),
    ##   `Free Crossover` = col_logical(),
    ##   `Entrance Latitude` = col_double(),
    ##   `Entrance Longitude` = col_double()
    ## )

    ## See spec(...) for full column specifications.

The NYC transit dataset contains: Division, line, station names, station and entrance locations, routes in each station, differnet trains for each route in station, whether the station allows entrance or vending, entrance type, staffs, free crossover, North South and East West streets and corners,and ADA compliance.

Cleaning steps:

With the understanding of dataset, I noticed that the routes is speard across 11 columns. I used the "gather" function to transpose. Then, I used "seperate" function to split the "route\_number" column into "route" and "route\_number". After that, I used "filter" function to only detect observations with non-missing "route\_name". I used "select" function to retain the variables I need, and converted the "entry"" variable from character to a logical variable. For the last step, I arranged the dataset by "line"" and "station\_name".

The dimension of this dataset is 4270 by 10 dataset.

These data are tidy.

1.2 Distinct stations, stations are ADA compliant, and porportion of station entrances/exits without vending entrance

``` r
distinct_station = nrow(distinct(transit_data,station_name,line,.keep_all = TRUE))
distinct_station 
```

    ## [1] 465

``` r
ada_compliance = transit_data %>% 
  filter(ada == TRUE) %>% 
  distinct(station_name,line)
nrow(ada_compliance)
```

    ## [1] 84

``` r
allow_entrance = transit_data %>% 
  filter(entry==TRUE & vending == 'NO') %>% 
  distinct(line,station_name)

vending = transit_data %>% 
  filter(vending == 'NO') %>% 
  distinct(line,station_name)
proportion = nrow(allow_entrance)/nrow(vending)
proportion
```

    ## [1] 0.4343434

There are 465 distinct stations, 84 are ADA compliant, and 43% of station entrances/exists without vending allow entrance.

1.3 Distinct stations serve the A train? Of the stations that serve the A train, how many are ADA compliant?

``` r
a_train = transit_data %>% 
  filter(route_name=='A') %>% 
  distinct(station_name,line)
nrow(a_train)
```

    ## [1] 60

``` r
a_ada = transit_data %>% 
  filter(route_name=='A' & ada==TRUE) %>% 
  distinct(station_name,line)
nrow(a_ada)
```

    ## [1] 17

There are 60 distinct stations serve the A train; of the stations that serve the A train, 17 are ADA compliant.
