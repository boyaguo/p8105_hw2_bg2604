---
title: "p8105_hw2_bg2604"
author: "Boya Guo"
date: "10/5/2018"
output: github_document
---

```{r}
library(tidyverse)
library(readxl)
library(knitr)
```

```{r}
knitr::opts_chunk$set((echo = TRUE),
  fig.width = 6,
  fig.asp = .6,
  out.width = "90%"
)
```

## Problem 1 

1.1 Import NYC transit csv file usirng relative path, and clean the dataset.  

```{r 1.1}
transit_data = read_csv(file="./data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv")%>%
  janitor::clean_names() %>% 
  gather(key = route_number, value=route_name,route1:route11)%>%
  separate(route_number, into = c("route", "route_number"), sep = 5) %>%
  filter(!is.na(route_name))%>%
  select(line, station_name, station_latitude, station_longitude, route_number,route_name, entry, vending, entrance_type, ada)%>%
  mutate(entry=ifelse(entry=='YES',yes=TRUE,no=FALSE))%>%
  arrange(line,station_name)
```

The NYC transit dataset contains: 
Division, line, station names, station and entrance locations, routes in each station, differnet trains for each route in station, whether the station allows entrance or vending, entrance type, staffs, free crossover, North South and East West streets and corners,and ADA compliance.

Cleaning steps: 

With the understanding of dataset, I noticed that the routes is speard across 11 columns. I used the "gather" function to transpose. Then, I used "seperate" function to split the "route_number" column into "route"
and "route_number". After that, I used "filter" function to only detect observations with non-missing "route_name". I used "select" function to retain the variables I need, and converted the "entry"" variable from character to a logical variable. For the last step, I arranged the dataset by "line"" and "station_name". 

The dimension of this dataset is `r nrow(transit_data)` by `r ncol(transit_data)` dataset.

These data are tidy.


1.2 Distinct stations, stations are ADA compliant, and porportion of station entrances/exits without vending entrance  

```{r 1.2}
distinct_station = nrow(distinct(transit_data,station_name,line,.keep_all = TRUE))
distinct_station 

ada_compliance = transit_data %>% 
  filter(ada == TRUE) %>% 
  distinct(station_name,line)
nrow(ada_compliance)

allow_entrance = transit_data %>% 
  filter(entry==TRUE & vending == 'NO') %>% 
  distinct(line,station_name)

vending = transit_data %>% 
  filter(vending == 'NO') %>% 
  distinct(line,station_name)
proportion = nrow(allow_entrance)/nrow(vending)
proportion
```
There are 465 distinct stations, 84 are ADA compliant, and 43% of station entrances/exists without vending allow entrance. 

1.3 Distinct stations serve the A train? Of the stations that serve the A train, how many are ADA compliant?

```{r 1.3}


```





